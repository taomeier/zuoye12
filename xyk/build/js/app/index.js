require(["jquery","swiper","bscroll","render","getSlideAngle","text!bookTb","text!bookLr","text!bookMore"],function(c,d,t,p,o,a,e,n){c("body").append(a),c("body").append(e),c.ajax({url:"/api/index",dataType:"json",success:function(t){var a=t.items[0].data,e=t.items[1].data.data,o=t.items[2].data.data,n=[o[0]],i=t.items[3].data.data,s=t.items[4].data.data,l=t.items[5].data.data,r=t.items[6].data.data;p(a,c("#bannertpl"),c(".banner-wrap")),p(e,c("#t-b-tpl"),c(".week-table")),p(n,c("#l-r-tpl"),c(".book-ly")),p(o.slice(1),c("#list-tap_tpl"),c(".book-ly")),p(i,c("#l-r-tpl"),c(".book-woman")),p(s,c("#l-r-tpl"),c(".book-man")),p(l,c("#limit-tpl"),c(".limit-table")),p(r,c("#splendid-tpl"),c(".banner-list")),p(i,c("#book-frame"),c(".book-frame")),new d(".banner",{autoplay:!0,loop:!0,pagination:{el:".swiper-pagination"}})},error:function(t){console.warn(t)}});var i=new d(".wrap-swiper");c(".tab-item").on("click",function(){var t=c(this).index();i.slideTo(t),1==t?c(".line").addClass("move"):c(".line").removeClass("move"),c(this).addClass("active").siblings().removeClass("active")});var s,l,r,u=1,m="上拉加载更多",b="下拉可刷新",h="释放加载更多",f="松开可刷新",v="暂无数据",w=new t(".pull-scroll",{scrollY:!0,probeType:2,click:!0}),g=c(".pull-scroll>div"),k=c("html").css("fontSize"),y=44*parseFloat(k)/37.5;w.on("scroll",function(){this.y<this.maxScrollY-y?s&&s<u?g.attr("up",v):g.attr("up",h):this.y<this.maxScrollY-y/2&&(s&&s<u?g.attr("up",v):g.attr("up",m)),this.y>y?g.attr("down",f):this.y>y/2&&g.attr("down",b)}),w.on("scrollEnd",function(){s&&s<u?g.attr("up",v):g.attr("up",m),g.attr("down",b)}),w.on("touchEnd",function(){if(g.attr("up")===h){if(s&&s<u)return!1;t=u,c("body").append(n),c.ajax({url:"/api/recommend",dataType:"json",data:{pageNum:t,count:10},success:function(t){console.log(t),p(t.items,c("#book-more-tpl"),c(".book-more-list")),w.refresh(),s=t.total/10},error:function(t){console.warn(t)}}),u++}var t;g.attr("down")===f&&location.reload()}),document.addEventListener("touchstart",function(t){l=t.touches[0].pageX,r=t.touches[0].pageY},!1),document.addEventListener("touchend",function(t){var a,e;switch(a=t.changedTouches[0].pageX,e=t.changedTouches[0].pageY,o(l,r,a,e)){case 3:i.slideTo(1),c(".line").addClass("move"),c(".tab-item").eq(1).addClass("active").siblings().removeClass("active");break;case 4:i.slideTo(0),c(".line").removeClass("move"),c(".tab-item").eq(0).addClass("active").siblings().removeClass("active")}},!1),c(".icon-switch").on("click",function(){c(".book-frame").toggleClass("list-frame"),c(".icon-switch").toggleClass("switch-icon-btn")}),c(".top-search").on("click",function(){window.location.href="../../page/search.html"}),c(".icon-sign").on("click",function(){window.location.href="../../page/login.html"})});