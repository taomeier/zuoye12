require(["jquery","render","base64","storage","jsonp","getRequest","render"],function(n,o,t,c,e,i,o){var a=n(".set-t"),s=n(".set-b"),r=n(".mask"),l=n(".set-panel");n(".read-hml").on("click",".read-content",function(){a.show(),s.show(),r.show(),n(".font").removeClass("active")}),r.on("click",function(){a.hide(),s.hide(),n(this).hide(),l.hide()});var d=i().fiction_id,h=c.get("chapter_id")||1;function f(){n.ajax({url:"/api/artical",dataType:"json",data:{fiction_id:d,chapter_id:h},success:function(t){e({url:t.url,callback:"duokan_fiction_chapter",cache:!0,success:function(t){var c=n.base64("decode",t,!0),e=JSON.parse(c);o(e,n("#read-tpl"),n(".read-hml"),!0),n("p").css("font-size",u/37.5+"rem")}})},error:function(t){console.log(t)}})}n(".cur").html(h),f(),n.ajax({url:"/api/chapter",dataType:"json",data:{fiction_id:d},success:function(t){console.log(t),n(".total").html(t.item.toc.length)},error:function(t){console.log(t)}}),n(".prev-btn").on("click",function(){1<h&&(h-=1,f(),n(".cur").html(h),c.set("chapter_id",h))}),n(".next-btn").on("click",function(){h<5&&(h+=1,f(),n(".cur").html(h),c.set("chapter_id",h))}),n(".catalog-btn").on("click",function(){window.location.href="../../page/book-Chapter.html?fiction_id="+d+"&chapter_id="+h}),n(".icon-circle-back").on("click",function(){window.location.href="../../page/book-detail.html?fiction_id="+d}),n(".font-btn").on("click",function(){n(".font").toggleClass("active"),n(".font").hasClass("active")?l.show():l.hide()});var u=c.get("fz")||14;n(".read-hml").show(),n(".big-btn").on("click",function(){u<20&&(u+=2,c.set("fz",u)),n("p").css("font-size",u/37.5+"rem")}),n(".small-btn").on("click",function(){10<u&&(u-=2,c.set("fz",u)),n("p").css("font-size",u/37.5+"rem")});var g="#0f1410",m=!!c.get("mark"),b=c.get("bg")||"#f7eee5";m?(n(".read-hml").css("background",g),n(".night").addClass("day").next().html("白天")):n(".read-hml").css("background",b),n("ul li").on("click",function(){n(this).addClass("active").siblings().removeClass("active"),b=n(this).attr("bg-color"),c.set("bg",b),m||n(".read-hml").css("background",b)}),n(".night-btn").on("click",function(){n(".night").toggleClass("day");var t=(m=n(".night").hasClass("day"))?"白天":"夜间";n(this).children("dd").text(t),m?n(".read-hml").css("background",g):n(".read-hml").css("background",b),c.set("mark",m)})});