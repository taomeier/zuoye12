require(["jquery","header","render","storage"],function(t,o,i,n){o({isSearch:!0});var e=n.get("history")||[],a=[];function s(o){t.ajax({url:"/api/search",dataType:"json",data:{key:o},success:function(o){t(".book-list>div").html(""),o?i(o.items,t("#book-tpl"),t(".book-list>div")):t(".result").append("<p>没有相应的搜索结果</p>")},error:function(o){console.warn(o)}})}e.forEach(function(o){return-1===a.indexOf(o)&&a.push(o),a}),i(a,t("#tag-tpl"),t(".book-tag")),t(".search-btn").on("click",function(){var o=t(".inp").val();t(".book-tag").hide(),t(".book-list>div").show(),o?(e.push(o),n.set("history",e),s(o)):t(".result").append("<p>没有相应的搜索结果</p>")}),t(".inp").on("input",function(){t(this).val()||(t(".book-tag").show(),t(".book-list>div").html(""),t(".book-list>div").hide())}),t(".book-tag").on("click","li",function(){t(".inp").val(t(this).text()),s(t(this).text()),t(".book-tag").hide(),t(".book-list>div").show()}),t(".render-header").on("click",".icon-back",function(){window.location.href="../../index.html"})});